ROM images for programming into the FPGA 8Kbyte ROM. A ROM image must:

* be in Intel .hex format
* be assembled to execute from $E000
* include the reset and other exception vectors
* have an entry point corresponding to the value of the reset vector
* despite the execution address of $E000, the .hex file must contain addresses $0000-$1FFF

The script 'buildit' can be used to assemble a file in order to produce a suitable .hex file. For example:

    $ ./buildit foo.asm

Creates these files:

    foo.s19        -- executable in srecord format
    foo.lst        -- assembly listing
    foo.hex        -- executable in hex format
    foo.fixed_hex  -- executable in hex format, rebased from $e000 to $0000
                      ready to program into an FPGA ROM

There are 2 'production' ROMs for multicomp6809 and several 'debug' ROMs. The 'production' ROMs are:

    CAMELFORTH_2KRAM.hex
    M6809_CAMELFORTH_ROM.cmp
    M6809_CAMELFORTH_ROM.cnx
    M6809_CAMELFORTH_ROM.qip
    M6809_CAMELFORTH_ROM.vhd

    EXT_BASIC_NO_USING.hex
    M6809_EXT_BASIC_ROM.cmp
    M6809_EXT_BASIC_ROM.qip
    M6809_EXT_BASIC_ROM.vhd

The .hex file is the ROM content and the other files are required by the Altera
tool chain to instance a ROM in the design. The BASIC ROM is Grant's port of
Microsoft BASIC. The CAMELFORTH ROM is my port of Brad Rodruigez's 6809 Camel
FORTH.

My multicomp6809 is set up to use the CAMELFORTH ROM. My SDcard image includes
the Microsoft BASIC and FORTH provides the work BASIC to load and start it.

The '_2KRAM' in the name of the CAMELFORTH image refers to RAM address space
that the code is set up to run with.

I'm not sure why there is a .cnx file for the CAMELFORTH ROM and not for the
other ROM; it doesn't seem to be needed.

## Rebuilding the BASIC ROM

Start with basic.asm (Tweaked version of Grant's original source)

    $ ./buildit basic.asm

This now matches Grant's original EXT_BASIC_NO_USING.hex with these exceptions:

* his image has the unused locations (between the end of the code and the start of
the vectors) filled, whereas the new image omits them. The FPGA flow does not care.
* his image has an "End of file" record, whereas the new image does not. The FPGA
flow does not care.

In order to put the BASIC image onto the SDcard, a binary image is required, which can be created like this:

    $ ../../../bin/hex2bin EXT_BASIC_NO_USING.hex > EXT_BASIC_NO_USING.bin

## Rebuilding the CAMELFORTH ROM

Start with 6809M.HEX, the file generated by the CAMEL FORTH compilation process.

    $ ../../../bin/hex_addr_remap e000 6809M.HEX > CAMELFORTH_2KRAM.hex

## Other files here

* defines.asm -- IO address defines for multicomp6809.
* nmi_real.asm -- Type-in test program for running under the control of BUGGY the debug monitor. Demonstrates behaviour of the multicomp6809 NMI-based single-step logic.
* timer_test.asm -- Type-in test program for running under the control of CAMELFORTH. Demonstrates the operation of the periodic timer and its interrupt capability.

The other .asm files were all written to exercise bits of the VHDL in a logic simulation.

* gpiotest.asm -- test program for RTL simulation of GPIO unit.
* insbug.asm -- test program for RTL simulation of VDU line-insert bug (and its fix).
* nmi_sstep.asm -- test program for RTL simulation of the NMI single-step logic.
* romdis.asm -- -- test program for RTL simulation of the paging register: ROM disable.
* scrollbug.asm -- test program for RTL simulation of VDU scroll bug (and its fix).
* sdtest.asm -- test program for RTL simulation of the SDcard controller.
* tinttest.asm -- test program for RTL simulation of the periodic timer and timer interrupt.
* uarttest.asm -- test program for RTL simulation of the UART.

Each of these can be built using the script 'buildit'.
